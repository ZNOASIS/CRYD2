# CRYD2
## 一、损失函数与训练策略
由于骨骼关键点的序列数据天然具有时空图的结构，适用于作为图神经网络的输入，目前主流的基于骨骼关键点的动作识别算法大多基于图神经网络。相较于基于CNN与RNN的模型，图神经网络能够在较少的参数量下取得较高的识别精度。本次比赛中，我们的模型使用目前最优的骨骼关键点识别模型CTR-GCN，SkateFormer,ske_former作为backbone，并使用带Label Smoothing的交叉熵作为损失函数，提升模型对困难样本的区分能力。在数据处理阶段，我们使用上采样策略缓解类别不均衡问题，利用分段随机采样的方法处理序列长度不均衡的问题，并引入了骨骼向量、骨骼角度、以及运动速度等多种特征特征训练模型，提升模型的准确率与鲁棒性。模型的框图如图1.1所示。

![](https://github.com/ZNOASIS/CRYD2/blob/main/1.1.png)

图1.1 模型框图

## 二、数据处理
### 1、	标签平滑的损失函数
我们没有使用传统的交叉熵函数而是改进为标签平滑的损失函数（Label Smoothing Loss），它适用于分类任务，标签平滑的损失函数可以有效提高模型的泛化能力，减轻过拟合。
损失函数的表达式:

$$
L=(1-smoothing) \times(- \log( P_{target} ) )+smoothing \times(-{{1}\over {C}} \sum\limits_{i=1}^C \log( p_{i} )  )
$$

- smoothing 是标签平滑参数 ，通常设量为一个小的正数，用于平滑目标标签，避免将模型的预测强制逼近一个精确的类别。
- $P_{target} $是模型预测的目标类别的概率
- C 是类别数， $p_{i} $是预测的类别i的概率
### 2、余弦退火
在训练策略的选择上，我们使用带Momentum的SGD算法作为模型的优化器，并使用带Warm-Up的余弦退火(Consine Annealing)策略作为学习率衰减的方法。实验中我们发现逐epoch的学习率衰减性能优于逐iteration的学习率衰减策略，因此我们最终选用了逐epoch的余弦退火作为我们的学习率衰减策略。
所有的实验中，我们取epoch = 90，max_lr =0.1，start_lr = 0.01，momentum =0.9。同时，为了进一步缓解模型的过拟合，我们对网络参数加上了幅度为4e-4的L2 weight decay项。
